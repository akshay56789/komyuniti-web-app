{% load i18n %}
<form class="new-post-form shadow rounded-4 p-3 mb-4 bg-white" action="" method="post" enctype="multipart/form-data" style="width: 100%; max-width: 900px; margin: 2rem auto;">
  {% csrf_token %}
  <div class="d-flex align-items-start mb-3">
    <img src="{{request.user.avatar.url}}" alt="Avatar" class="rounded-circle me-3 border" style="height: 3rem; width: 3rem; object-fit: cover;">
    <div class="flex-grow-1">
      <textarea name="body" id="body" rows="3" class="form-control border-0 shadow-sm" style="resize: none; background: #f5f6fa;" placeholder="{% trans "What's on your mind," %} @{{request.user.username}}?"></textarea>
    </div>
  </div>
  <div class="d-flex justify-content-between align-items-center">
    <div>
      <label for="image-upload" class="btn btn-light btn-sm rounded-circle me-2" title="{% trans 'Attach image' %}" style="box-shadow: 0 1px 3px rgba(0,0,0,0.07);">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#6c63ff" class="bi bi-image" viewBox="0 0 16 16">
          <path d="M14.002 3a1 1 0 0 1 1 1v8a1 1 0 0 1-1 1h-12a1 1 0 0 1-1-1v-8a1 1 0 0 1 1-1h12zm0-1h-12A2 2 0 0 0 0 4v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V4a2 2 0 0 0-2-2z"/>
          <path d="M10.648 8.646a.5.5 0 0 1 .704.058l2.646 3.182V4a1 1 0 0 0-1-1h-12a1 1 0 0 0-1 1v7.886l3.646-4.364a.5.5 0 0 1 .708-.058l2.646 2.646 2.646-2.646z"/>
          <circle cx="4.5" cy="6.5" r="1"/>
        </svg>
        <input id="image-upload" type="file" name="image" accept="image/*" style="display: none;">
      </label>
      <label for="youtube-link" class="btn btn-light btn-sm rounded-circle" title="{% trans 'Embed YouTube' %}" style="box-shadow: 0 1px 3px rgba(0,0,0,0.07);">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" fill="#ff5252" class="bi bi-youtube" viewBox="0 0 16 16">
          <path d="M8.051 1.999h-.002C3.634 2.01 1.5 2.5 1.5 8s2.134 5.99 6.549 6.001h.002c4.417-.011 6.549-.501 6.549-6.001s-2.132-5.99-6.549-6.001zm0 1.002c4.02.01 5.5.48 5.5 6s-1.48 5.99-5.5 6c-4.02-.01-5.5-.48-5.5-6s1.48-5.99 5.5-6zm-1.051 3.999v4l3.5-2-3.5-2z"/>
        </svg>
      </label>
    </div>
    <button onclick="spinner()" type="submit" class="btn btn-primary rounded-pill px-4 shadow-sm" style="background: linear-gradient(90deg, #6c63ff 0%, #48c6ef 100%); border: none;">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" fill="white" class="bi bi-send me-1" viewBox="0 0 16 16">
        <path d="M15.854.146a.5.5 0 0 1 .11.54l-5.819 14.547a.75.75 0 0 1-1.329.124l-3.178-4.995L.643 7.184a.75.75 0 0 1 .124-1.33L15.314.037a.5.5 0 0 1 .54.11ZM6.636 10.07l2.761 4.338L14.13 2.576zm6.787-8.201L1.591 6.602l4.339 2.76z"/>
      </svg>
      {% trans "Post" %}
    </button>
  </div>
  <div id="youtube-link-field" class="mt-3" style="display: none;">
    <input type="text" name="embed" id="youtube-link" class="form-control" placeholder="https://youtube.com/embed/YourCode">
  </div>
</form>
<script>
  // Show YouTube link input when icon is clicked
  document.querySelector('label[for="youtube-link"]').addEventListener('click', function(e) {
    e.preventDefault();
    document.getElementById('youtube-link-field').style.display = 'block';
    document.getElementById('youtube-link').focus();
  });
</script>
<style>
  .new-post-form textarea:focus {
    background: #e9ecef;
    box-shadow: 0 0 0 2px #6c63ff33;
  }
  .new-post-form .btn-light:hover {
    background: #f0f0ff;
  }
  .new-post-form .btn-primary:active {
    background: #5a54e8 !important;
  }
</style>